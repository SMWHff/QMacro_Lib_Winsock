<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
	<title>按键精灵命令库帮助</title>
	<script type="text/javascript" src="http://www.vrbrothers.com/cn/qmacro/qmdn/scripts/shCore.js" charset="gbk"></script>
	<link rel="stylesheet" type="text/css" href="http://www.vrbrothers.com/cn/qmacro/qmdn/css/SyntaxHighlighter.css">
	<link rel="stylesheet" type="text/css" href="http://www.vrbrothers.com/cn/qmacro/qmdn/css/help.css">
	<style>
	body{font-size:12px; font-family:Verdana,"宋体"}
	.ts{ background:#fff; margin:0 0 40px 0;}
	.ts th{ color:#7B797B; background:#DEDFDE; line-height:24px;}
	.ts td {padding:6px 0;}
	.name { font-size:16px; font-weight:bold; border-top:1px dashed #9C9A9C; border-bottom:1px dashed #9C9A9C; color:#006939;}
	.canshu { background:#E7E7EF;}
	.red{ color:#d60000;}
	.green{ color:#006939;}
	.fanhui{ border-bottom:1px dashed #9C9A9C;}
	.lizi{ border-bottom:1px dashed #9C9A9C;}

	/* Language specific styles */
    /*
	  comment 为注释代码着色
	  string  为字符串文字着色
	  keyword 为关键字着色
	  preprocessor 自定义规则着色
	*/
	.dp-highlighter .comment, .dp-highlighter .comments { color: darkgreen; background-color: inherit; }
	.dp-highlighter .string { color: darkgray; background-color: inherit; }
	.dp-highlighter .keyword { color: #0000FF; font-weight: bold; background-color: inherit; }
	.dp-highlighter .preprocessor { color: #FF00FF; background-color: inherit; }
	</style>
</head>
<body>


<table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
<tr><th width="100px">命令名称：</th><td class="name">
<a name="Sock_初始化"></a>Sock_初始化
</td></tr><tr><th>命令功能：</th><td>
初始化套接字对象
</td></tr><tr><th>命令参数：</th><td class="canshu"><pre>
无
</td></tr><tr><th>返回值：</th><td class="fanhui">
逻辑型，是否成功
</td></tr><tr><th>脚本例子：<br /><span class="red">按键精灵8及<br />以上语法</span>
</th><td class="lizi"><pre name="code8_Sock_初始化" class="vb" id="code8_Sock_初始化">
//调用该命令库前必须先初始化
If Lib.神梦_套接字.Sock_初始化() Then 
	TracePrint "调用成功！"
Else 
	TracePrint "出错，调用失败！"
	ExitScript 
End If
</td></tr></table>


<table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
<tr><th width="100px">命令名称：</th><td class="name">
<a name="Sock_销毁"></a>Sock_销毁
</td></tr><tr><th>命令功能：</th><td>
初始化套接字对象
</td></tr><tr><th>命令参数：</th><td class="canshu"><pre>
无
</td></tr><tr><th>返回值：</th><td class="fanhui">
无
</td></tr><tr><th>脚本例子：<br /><span class="red">按键精灵8及<br />以上语法</span>
</th><td class="lizi"><pre name="code8_Sock_销毁" class="vb" id="code8_Sock_销毁">
//销毁套接字对象 
Call Lib.神梦_套接字.Sock_销毁()
</td></tr></table>


<table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
<tr><th width="100px">命令名称：</th><td class="name">
<a name="方法_绑定端口"></a>方法_绑定端口
</td></tr><tr><th>命令功能：</th><td>
可以把一个端口号固定为本控件使用，使得别的应用程序不能再使用这个端口。
</td></tr><tr><th>命令参数：</th><td class="canshu"><pre>
参数1【必选】：整数型，端口（范围0~65535）
</td></tr><tr><th>返回值：</th><td class="fanhui">
无
</td></tr><tr><th>脚本例子：<br /><span class="red">按键精灵8及<br />以上语法</span>
</th><td class="lizi"><pre name="code8_方法_绑定端口" class="vb" id="code8_方法_绑定端口">
'绑定用来获取信息的端口
Call Lib.神梦_套接字.方法_绑定端口(1001)
</td></tr></table>


<table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
<tr><th width="100px">命令名称：</th><td class="name">
<a name="方法_发送数据"></a>方法_发送数据
</td></tr><tr><th>命令功能：</th><td>
当连接建立后，就可以调用发送数据，该方法只有一个参数，就是要发送的数据。
</td></tr><tr><th>命令参数：</th><td class="canshu"><pre>
参数1【必选】：字符串，远程IP
参数2【必选】：整数型，远程端口（范围0~65535）
参数3【必选】：变体型，数据
</td></tr><tr><th>返回值：</th><td class="fanhui">
无
</td></tr><tr><th>脚本例子：<br /><span class="red">按键精灵8及<br />以上语法</span>
</th><td class="lizi"><pre name="code8_方法_发送数据" class="vb" id="code8_方法_发送数据">
//给本机IP发消息
Call Lib.神梦_套接字.方法_发送数据("127.0.0.1", 1001, "发给本地IP的消息！")
</td></tr></table>


<table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
<tr><th width="100px">命令名称：</th><td class="name">
<a name="方法_发送文件"></a>方法_发送文件
</td></tr><tr><th>命令功能：</th><td>
当连接建立后，发送一个文件给对方
</td></tr><tr><th>命令参数：</th><td class="canshu"><pre>
参数1【必选】：字符串，远程IP
参数2【必选】：整数型，远程端口（范围0~65535）
参数3【必选】：字符串，文件路径
</td></tr><tr><th>返回值：</th><td class="fanhui">
无
</td></tr><tr><th>脚本例子：<br /><span class="red">按键精灵8及<br />以上语法</span>
</th><td class="lizi"><pre name="code8_方法_发送文件" class="vb" id="code8_方法_发送文件">
'给服务端发送一个文件
Path = "C:\123.jpg"
Call Lib.神梦_套接字.方法_发送文件("127.0.0.1", 1001, Path)
</td></tr></table>


<table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
<tr><th width="100px">命令名称：</th><td class="name">
<a name="方法_关闭"></a>方法_关闭
</td></tr><tr><th>命令功能：</th><td>
关闭套接字对象，取消端口绑定
</td></tr><tr><th>命令参数：</th><td class="canshu"><pre>
无
</td></tr><tr><th>返回值：</th><td class="fanhui">
无
</td></tr><tr><th>脚本例子：<br /><span class="red">按键精灵8及<br />以上语法</span>
</th><td class="lizi"><pre name="code8_方法_关闭" class="vb" id="code8_方法_关闭">
'取消绑定
Call Lib.神梦_套接字.方法_关闭()
</td></tr></table>


<table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
<tr><th width="100px">命令名称：</th><td class="name">
<a name="方法_接收数据"></a>方法_接收数据
</td></tr><tr><th>命令功能：</th><td>
当本地计算机接收到远程计算机的数据时，数据存放在缓冲区中，该方法可以从缓冲区中取出数据
</td></tr><tr><th>命令参数：</th><td class="canshu"><pre>
参数1【必选】：整数型，超时时间，单位秒，0为不限时间
</td></tr><tr><th>返回值：</th><td class="fanhui">
数组型，数组-1=获取超时；数组0=对方ip，数组1=字节集数据
</td></tr><tr><th>脚本例子：<br /><span class="red">按键精灵8及<br />以上语法</span>
</th><td class="lizi"><pre name="code8_方法_接收数据" class="vb" id="code8_方法_接收数据">
'接收客户端的请求
ret = Lib.神梦_套接字.方法_接收数据(0)
If UBound(ret) > - 1  Then 
    TracePrint "【服务端】收到:" & ret(0) & ":" & ret(1)
End If
</td></tr></table>


<table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
<tr><th width="100px">命令名称：</th><td class="name">
<a name="方法_接收文件"></a>方法_接收文件
</td></tr><tr><th>命令功能：</th><td>
接收从远程发送过来的文件
</td></tr><tr><th>命令参数：</th><td class="canshu"><pre>
参数1【必选】：整数型，超时时间，单位秒，0为不限时间
</td></tr><tr><th>返回值：</th><td class="fanhui">
数组型，数组-1=获取超时；数组0=对方ip，数组1=字节集数据
</td></tr><tr><th>脚本例子：<br /><span class="red">按键精灵8及<br />以上语法</span>
</th><td class="lizi"><pre name="code8_方法_接收文件" class="vb" id="code8_方法_接收文件">
'接收客户端的请求
Path = "C:\999.jpg"
ret = Lib.神梦_套接字.方法_接收文件(Path, 0)
If UBound(ret) > - 1  Then 
	TracePrint "接收文件成功！对方IP：" & ret(0)
End If
</td></tr></table>


<table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
<tr><th width="100px">命令名称：</th><td class="name">
<a name="属性_取本地端口"></a>属性_取本地端口
</td></tr><tr><th>命令功能：</th><td>
取得本地端口
</td></tr><tr><th>命令参数：</th><td class="canshu"><pre>
无
</td></tr><tr><th>返回值：</th><td class="fanhui">
整数型，本地端口
</td></tr><tr><th>脚本例子：<br /><span class="red">按键精灵8及<br />以上语法</span>
</th><td class="lizi"><pre name="code8_属性_取本地端口" class="vb" id="code8_属性_取本地端口">
返回值 = Lib.神梦_套接字.属性_取本地端口()
TracePrint 返回值
</td></tr></table>


<table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
<tr><th width="100px">命令名称：</th><td class="name">
<a name="属性_取本地主机IP"></a>属性_取本地主机IP
</td></tr><tr><th>命令功能：</th><td>
取得本地主机IP
</td></tr><tr><th>命令参数：</th><td class="canshu"><pre>
无
</td></tr><tr><th>返回值：</th><td class="fanhui">
字符串，本地主机IP
</td></tr><tr><th>脚本例子：<br /><span class="red">按键精灵8及<br />以上语法</span>
</th><td class="lizi"><pre name="code8_属性_取本地主机IP" class="vb" id="code8_属性_取本地主机IP">
返回值 = Lib.神梦_套接字.属性_取本地主机IP()
TracePrint 返回值
</td></tr></table>


<table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
<tr><th width="100px">命令名称：</th><td class="name">
<a name="属性_取本地主机名"></a>属性_取本地主机名
</td></tr><tr><th>命令功能：</th><td>
取得本地主机名
</td></tr><tr><th>命令参数：</th><td class="canshu"><pre>
无
</td></tr><tr><th>返回值：</th><td class="fanhui">
字符串，本地主机名
</td></tr><tr><th>脚本例子：<br /><span class="red">按键精灵8及<br />以上语法</span>
</th><td class="lizi"><pre name="code8_属性_取本地主机名" class="vb" id="code8_属性_取本地主机名">
返回值 = Lib.神梦_套接字.属性_取本地主机名()
TracePrint 返回值
</td></tr></table>


<table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
<tr><th width="100px">命令名称：</th><td class="name">
<a name="属性_取数据量"></a>属性_取数据量
</td></tr><tr><th>命令功能：</th><td>
获取接收到的（当前在接收端缓冲区内的）数据的数量
</td></tr><tr><th>命令参数：</th><td class="canshu"><pre>
无
</td></tr><tr><th>返回值：</th><td class="fanhui">
整数型，数据的数量
</td></tr><tr><th>脚本例子：<br /><span class="red">按键精灵8及<br />以上语法</span>
</th><td class="lizi"><pre name="code8_属性_取数据量" class="vb" id="code8_属性_取数据量">
返回值 = Lib.神梦_套接字.属性_取数据量()
TracePrint 返回值
</td></tr></table>


<table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
<tr><th width="100px">命令名称：</th><td class="name">
<a name="属性_取远程IP"></a>属性_取远程IP
</td></tr><tr><th>命令功能：</th><td>
取得远程IP
</td></tr><tr><th>命令参数：</th><td class="canshu"><pre>
无
</td></tr><tr><th>返回值：</th><td class="fanhui">
字符串，远程IP
</td></tr><tr><th>脚本例子：<br /><span class="red">按键精灵8及<br />以上语法</span>
</th><td class="lizi"><pre name="code8_属性_取远程IP" class="vb" id="code8_属性_取远程IP">
返回值 = Lib.神梦_套接字.属性_取远程IP()
TracePrint 返回值
</td></tr></table>


<table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
<tr><th width="100px">命令名称：</th><td class="name">
<a name="属性_取远程端口"></a>属性_取远程端口
</td></tr><tr><th>命令功能：</th><td>
取得远程端口
</td></tr><tr><th>命令参数：</th><td class="canshu"><pre>
无
</td></tr><tr><th>返回值：</th><td class="fanhui">
整数型，远程端口
</td></tr><tr><th>脚本例子：<br /><span class="red">按键精灵8及<br />以上语法</span>
</th><td class="lizi"><pre name="code8_属性_取远程端口" class="vb" id="code8_属性_取远程端口">
返回值 = Lib.神梦_套接字.属性_取远程端口()
TracePrint 返回值
</td></tr></table>


<table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
<tr><th width="100px">命令名称：</th><td class="name">
<a name="属性_取状态"></a>属性_取状态
</td></tr><tr><th>命令功能：</th><td>
取得远程端口
</td></tr><tr><th>命令参数：</th><td class="canshu"><pre>
无
</td></tr><tr><th>返回值：</th><td class="fanhui">
整数型，状态
		0 缺省的。关闭 
		1 打开 
		2 侦听 
		3 连接挂起 
		4 识别主机 
		5 已识别主机 
		6 正在连接 
		7 已连接 
		8 同级人员正在关闭连接 
		9 错误
</td></tr><tr><th>脚本例子：<br /><span class="red">按键精灵8及<br />以上语法</span>
</th><td class="lizi"><pre name="code8_属性_取状态" class="vb" id="code8_属性_取状态">
返回值 = Lib.神梦_套接字.属性_取状态()
TracePrint 返回值
</td></tr></table>


<table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
<tr><th width="100px">命令名称：</th><td class="name">
<a name="应用_网卡唤醒"></a>应用_网卡唤醒
</td></tr><tr><th>命令功能：</th><td>
发送远程开机（网卡唤醒）魔术数据包
</td></tr><tr><th>命令参数：</th><td class="canshu"><pre>
参数1【必选】：字符串，远程网卡MAC
参数2【必选】：字符串，远程IP
参数3【必选】：整数型，远程端口（范围0~65535）
</td></tr><tr><th>返回值：</th><td class="fanhui">
逻辑型，是否成功
</td></tr><tr><th>脚本例子：<br /><span class="red">按键精灵8及<br />以上语法</span>
</th><td class="lizi"><pre name="code8_应用_网卡唤醒" class="vb" id="code8_应用_网卡唤醒">
返回值 = Lib.神梦_套接字.应用_网卡唤醒("C8:FF:28:CE:13:2D", "192.168.1.100", 100)
If 返回值 Then 
	TracePrint "发送成功！"
Else 
	TracePrint "发送失败！"
End If
</td></tr></table>



<table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
<tr><th width="100px">命令名称：</th><td class="name">
<a name="应用_时钟同步"></a>应用_时钟同步
</td></tr><tr><th>命令功能：</th><td>
发送时钟同步数据包，并同步本机时间
</td></tr><tr><th>命令参数：</th><td class="canshu"><pre>
参数1【必选】：字符串，时钟服务器IP
        阿里：ntp.aliyun.com 
        腾讯：time1.cloud.tencent.com 
        微软：time.windows.com 
        苹果：time.apple.com 
        谷歌：time.google.com 
        高通：time.izatcloud.net
        官方：ntp.ntsc.ac.cn
        清华：ntp.tuna.tsinghua.edu.cn
</td></tr><tr><th>返回值：</th><td class="fanhui">
字符串，日期时间
</td></tr><tr><th>脚本例子：<br /><span class="red">按键精灵8及<br />以上语法</span>
</th><td class="lizi"><pre name="code8_应用_时钟同步" class="vb" id="code8_应用_时钟同步">
返回值 = Lib.神梦_套接字.应用_时钟同步("ntp.aliyun.com")
TracePrint 返回值
</td></tr></table>


<script type="text/javascript">
	dp.sh.Brushes.Vb = function()
	{ 
		var keywords = 'vbBlack vbRed vbGreen vbYellow vbBlue vbMagenta vbCyan vbWhite vbBinaryCompare vbTextCompare vbSunday vbMonday vbTuesday vbWednesday ' + 
		'vbThursday vbFriday vbSaturday vbUseSystemDayOfWeek vbFirstJan1 vbFirstFourDays vbFirstFullWeek vbGeneralDate vbLongDate vbShortDate vbLongTime ' + 
		'vbShortTime vbObjectError vbOKOnly vbOKCancel vbAbortRetryIgnore vbYesNoCancel vbYesNo vbRetryCancel vbCritical vbQuestion vbExclamation vbInformation ' + 
		'vbDefaultButton1 vbDefaultButton2 vbDefaultButton3 vbDefaultButton4 vbApplicationModal vbSystemModal vbOK vbCancel vbAbort vbRetry vbIgnore vbYes vbNo '+
		'vbCr vbCrLf vbFormFeed vbLf vbNewLine vbNullChar vbNullString vbTab vbVerticalTab vbUseDefault vbTrue vbFalse vbEmpty vbNull vbInteger vbLong vbSingle '+
		'vbDouble vbCurrency vbDate vbString vbObject vbError vbBoolean vbVariant vbDataObject vbDecimal vbByte vbArray WScript '+
		'And As Boolean ByRef Byte ByVal Call Case Const Currency Debug Dim Do Double Each Else ElseIf Empty End EndIf Enum Eqv Event Exit Explicit False For '+ 
		'Function Get Goto If Imp Implements In Integer Is Let Like Long Loop LSet Me Mod New Next Not Nothing Null On Option Optional Or ParamArray Preserve '+
		'Private Property Public RaiseEvent ReDim Rem Resume RSet Select Set Shared Single Static Stop Sub Then To True Type TypeOf Until Variant WEnd While With '+
		'Xor IfColor Import UserVar SetSimMode Global EndScript ExitScript RestartScript Delay VBSBegin VBSEnd Lib Alias Declare Plugin ' +
		'Abs Array Asc Atn CBool CByte CCur CDate CDbl CInt CLng CSng CStr Chr Cos CreateObject Date DateAdd DateDiff DatePart DateSerial DateValue Day Escape '+
		'Eval Exp Filter Fix FormatCurrency FormatDateTime FormatNumber FormatPercent GetLocale GetObject GetRef Hex Hour InStr InStrRev InputBox Int IsArray '+
		'IsDate IsEmpty IsNull IsNumeric IsObject Join LBound LCase LTrim Left Len LoadPicture Log Mid Minute Month MonthName MsgBox Now Oct Randomize RGB RTrim '+
		'Replace Right Rnd Round ScriptEngine ScriptEngineBuildVersion ScriptEngineMajorVersion ScriptEngineMinorVersion Second SetLocale Sgn Sin Space Split Sqr '+
		'StrComp StrReverse String Tan Time TimeSerial TimeValue Timer Trim TypeName UBound UCase Unescape VarType Weekday WeekdayName Year KeyGroup KeyPress '+
        'KeyPressH KeyPressS KeyDown KeyDownH KeyDownS KeyUp KeyUpH KeyUpS WaitKey GetLastKey LeftClick LeftClickH LeftClickS LeftDoubleClick LeftDoubleClickH '+
		'LeftDoubleClickS LeftDown LeftDownH LeftDownS LeftUp LeftUpH LeftUpS RightClick RightClickH RightClickS RightDown RightDownH RightDownS RightUp '+
		'RightUpH RightUpS MiddleClick MiddleClickH MiddleClickS MoveTo MoveToH MoveToS MoveR MoveRH MoveRS MouseWheel SaveMousePos RestoreMousePos LockMouse '+
		'UnlockMouse WaitClick GetLastClick GetCursorPos GetCursorShape GetPixelColor FindColor FindColorEx FindCenterColor FindPic GetmacroID SayString '+
		'MessageBox RunApp PutAttachment TracePrint LogStart LogStop BeginThread StopThread PauseThread ContinueThread GetThreadID SetEnv GetEnv Beep Execute '+
		'GetExeDir GetScreenResolution ExecuteGlobal '+
		'Bkgnd BkgndColor Color Console Encrypt File GetSysInfo Media Memory Msg Net Office Pic Sys Web Window';
		this.regexList = [
			{ regex: new RegExp('(//|\').*$', 'gm'), css: 'comment' }, 
			{ regex: dp.sh.RegexLib.DoubleQuotedString, css: 'string' }, 
			{ regex: new RegExp(this.GetKeywords('dm'), 'gm'), css: 'preprocessor' }, 
			{ regex: new RegExp(this.GetKeywords(keywords), 'gm'), css: 'keyword'}
		]; 
		this.CssClass = 'dp-vb'; 
	}
	dp.sh.Brushes.Vb.prototype = new dp.sh.Highlighter(); dp.sh.Brushes.Vb.Aliases = ['vb', 'vb.net'];
    dp.SyntaxHighlighter.ClipboardSwf = "http://www.vrbrothers.com/cn/qmacro/qmdn/htmls/zh_chs/qm/scripts/clipboard.swf";
	dp.SyntaxHighlighter.HighlightAll('code8_Sock_初始化',true,true,false);
	dp.SyntaxHighlighter.HighlightAll('code8_Sock_销毁',true,true,false);
	dp.SyntaxHighlighter.HighlightAll('code8_方法_绑定端口',true,true,false);
	dp.SyntaxHighlighter.HighlightAll('code8_方法_发送数据',true,true,false);
	dp.SyntaxHighlighter.HighlightAll('code8_方法_发送文件',true,true,false);
	dp.SyntaxHighlighter.HighlightAll('code8_方法_关闭',true,true,false);
	dp.SyntaxHighlighter.HighlightAll('code8_方法_接收数据',true,true,false);
	dp.SyntaxHighlighter.HighlightAll('code8_方法_接收文件',true,true,false);
	dp.SyntaxHighlighter.HighlightAll('code8_属性_取本地端口',true,true,false);
	dp.SyntaxHighlighter.HighlightAll('code8_属性_取本地主机IP',true,true,false);
	dp.SyntaxHighlighter.HighlightAll('code8_属性_取本地主机名',true,true,false);
	dp.SyntaxHighlighter.HighlightAll('code8_属性_取数据量',true,true,false);
	dp.SyntaxHighlighter.HighlightAll('code8_属性_取远程IP',true,true,false);
	dp.SyntaxHighlighter.HighlightAll('code8_属性_取远程端口',true,true,false);
	dp.SyntaxHighlighter.HighlightAll('code8_属性_取状态',true,true,false);
	dp.SyntaxHighlighter.HighlightAll('code8_应用_网卡唤醒',true,true,false);
	dp.SyntaxHighlighter.HighlightAll('code8_应用_时钟同步',true,true,false);
</script>  
</body>
</html>